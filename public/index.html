<!doctype html>
<html class="no-js ui-mobile-rendering" lang="en">
<head>
    <title>Twisted Vines</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- <link rel="stylesheet" href="css/themes/default/jquery.mobile.css"> -->
    <link rel="stylesheet" href="css/themes/default/jquery.mobile-1.4.5.min.css">
    <link rel="stylesheet" href="css/printable_sheet.css" media="print">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="css/vis.min.css">
    <link rel="stylesheet" href="css/nprogress.css">
    <style>
        #relationships-network {
            width: 640px;
            height: 480px;
            border: 1px solid lightgray;
            background-color:#333333;
        }
    </style>
    <!-- BEGIN TRACKJS -->
    <script type="text/javascript">
        window._trackJs = {
            token: '8c029fff54d841498640d86379af7316',
            enabled: !(window.location.host.indexOf('localhost') >= 0)
        };
        if (window.location.protocol != "https:") {
            window.location.href = "https:" + window.location.href.substring(window.location.protocol.length);
        }
        // Add a script element as a child of the body
        function downloadJSAtOnload() {
            var element = document.createElement("script");
            element.src = "scripts/lib/require.js";
            element.setAttribute("data-main", "scripts/app");
            document.body.appendChild(element);
        }

        // Check for browser support of event handling capability
        if (window.addEventListener)
            window.addEventListener("load", downloadJSAtOnload, false);
        else if (window.attachEvent)
            window.attachEvent("onload", downloadJSAtOnload);
        else window.onload = downloadJSAtOnload;
    </script>
    <script type="text/javascript" src="https://d2zah9y47r7bi2.cloudfront.net/releases/current/tracker.js"></script>
    <!-- END TRACKJS -->
</head>

<body>

<div id="splashscreen">
    <img src="UndergroundTheaterBlackLogo.jpg" style="visibility: visible; width: 100%"/>
    <p style="visibility: visible; width: 100%">Loading...</p>
</div>

<div data-role="header" data-position="fixed" data-theme="a">
    <a href="javascript:window.history.back()" data-icon="arrow-l" data-iconpos="left" data-rel="back" data-transition="slide" data-direction="reverse" id="header-back-button">Back</a>
    <a href="#logout" data-icon="minus" data-iconpos="right" data-transition="slide" data-direction="reverse" id="header-logout-button">Log Out</a>
    <h1>Default Title</h1>
</div><!-- /header -->

<div id="splashscreen" data-role="page" data-title="Yorick Splash Screen">
    <div role="main" class="ui-content">
        <img style="width:100%" src="UndergroundTheaterBlackLogo.jpg"/>
    </div>
</div>

<div id="login" data-role="page" data-title="Log In">
    <div role="main" class="ui-content">
        <img src="VinesLogoSmall.png"/>
    </div><!-- /content -->
</div>

<div id="signup" data-role="page" data-title="Sign Up">
    <div role="main" class="ui-content">
        <img src="VinesLogoSmall.png"/>
    </div><!-- /content -->
</div>

<div id="player-options" data-role="page" data-title="Player Options">
    <div role="main" class="ui-content">
    </div><!-- /content -->
</div>

<div id="administration" data-role="page" data-title="Administration">
    <div role="main" class="ui-content">
        <ul>
            <li><a href="#troupes">Troupes</a></li>
            <li><a href="#administration/characters/all">Characters</a></li>
        </ul>
    </div><!-- /content -->
</div>

<div id="troupe-new" data-role="page" data-title="New Troupe">
    <div role="main" class="ui-content">
        <form id="troupe-new-form"></form>
    </div><!-- /content -->
</div>

<div id="troupes-list" data-role="page" data-title="Troupes">
    <div role="main" class="ui-content">
        <ul>
            <li><a href="#troupe/new">Create Troupe</a></li>
        </ul>
        <div role="troupe-list"></div>
    </div>
</div>

<div id="character-pick-troupe-to-leave" data-role="page" data-title="Leave Troupe">
    <div role="main" class="ui-content">
        <div role="troupe-list"></div>
    </div>
</div>

<div id="character-pick-troupe-to-join" data-role="page" data-title="Join Troupe">
    <div role="main" class="ui-content">
        <div role="troupe-list"></div>
    </div>
</div>


<div id="troupe" data-role="page" data-title="Troupe">
    <div role="main" class="ui-content">
    </div>
</div>


<div id="troupe-add-staff" data-role="page" data-title="Add Staff">
    <div role="main" class="ui-content">
    </div>
</div>

<div id="troupe-edit-staff" data-role="page" data-title="Edit Staff">
    <div role="main" class="ui-content">
        <h1>Edit Staff</h1>
        <form id="troupe-edit-staff-form"></form>
    </div>
</div>

<div data-role="footer" data-position="fixed" data-theme="a">
    <div data-role="navbar">
        <ul>
            <li><a href="#" data-transition="fade">Top</a></li>
            <li><a href="#characters?all" data-transition="fade">Characters</a></li>
            <li><a href="#profile" data-transition="flip">Profile</a></li>
        </ul>
    </div>
</div>

<div id="character" data-role="page" data-title="Character">
    <div role="main" class="ui-content">
    </div>
</div>

<script id="characterView" type="text/template">
    <% if (character.is_being_created()) { %>
    <ul data-role="listview" data-inset="true" class="ui-listview ui-listview-inset ui-corner-all ui-shadow">
        <li><a href="#charactercreate/<%= character.id %>">Character Creation</a></li>
    </ul>
    <% } %>
    <ul data-role="listview" data-inset="true" class="ui-listview ui-listview-inset ui-corner-all ui-shadow">
        <li><a href="#character/<%= character.id %>/portrait">Character Portrait</a></li>
    </ul>
    <% _.each(character.all_simpletrait_categories(), function(grouping) { %>
        <% var description = grouping[1]; %>
        <% var category = grouping[0]; %>
        <ul data-role="listview" data-inset="true" class="ui-listview ui-listview-inset ui-corner-all ui-shadow">
            <li><a href="#simpletraits/<%= category %>/<%= character.id %>/all"><%= description %></a></li>
        </ul>
    <% }) %>

    <ul data-role="listview" data-inset="true" class="ui-listview ui-listview-inset ui-corner-all ui-shadow">
        <li><a href="#character/<%= character.id %>/history/0">History</a></li>
    </ul>
    <ul data-role="listview" data-inset="true" class="ui-listview ui-listview-inset ui-corner-all ui-shadow">
        <li><a href="#character/<%= character.id %>/experience/0/10">Experience Points</a></li>
    </ul>
    <ul data-role="listview" data-inset="true" class="ui-listview ui-listview-inset ui-corner-all ui-shadow">
        <li><a href="#character/<%= character.id %>/print">Print</a></li>
    </ul>
    <ul data-role="listview" data-inset="true" class="ui-listview ui-listview-inset ui-corner-all ui-shadow">
        <li><a href="#character/<%= character.id %>/costs">Costs</a></li>
    </ul>
    <ul data-role="listview" data-inset="true" class="ui-listview ui-listview-inset ui-corner-all ui-shadow">
        <li><a href="#character/<%= character.id %>/log/0/10">Log</a></li>
    </ul>
    <ul data-role="listview" data-inset="true" class="ui-listview ui-listview-inset ui-corner-all ui-shadow">
        <li><a href="#character/<%= character.id %>/troupes">Show My Troupes</a></li>
    </ul>
    <ul data-role="listview" data-inset="true" class="ui-listview ui-listview-inset ui-corner-all ui-shadow">
        <li><a href="#character/<%= character.id %>/troupes/join">Join Troupe</a></li>
    </ul>
    <ul data-role="listview" data-inset="true" class="ui-listview ui-listview-inset ui-corner-all ui-shadow">
        <li><a href="#character/<%= character.id %>/troupes/leave">Leave Troupe</a></li>
    </ul>
    <ul data-role="listview" data-inset="true" class="ui-listview ui-listview-inset ui-corner-all ui-shadow">
        <li><a href="#character/<%= character.id %>/delete">Delete Character</a></li>
    </ul>
</script>

<div id="character-create" data-role="page" data-title="Create Character">

    <div role="main" class="ui-content">
        createodapage
    </div>
</div>

<script id="characterCreateView" type="text/template">
    <% var creation = character.get("creation"); %>

    <p>You have <%= creation.get("initial_xp") %> initial XP to spend</p>
    <p>Remaining steps for <%= character.get("name") %></p>
    <% _.each(["clan", "archetype", "sect", "faction", "title"], function (st) { %>
        <% var ust = st[0].toUpperCase() + st.substr(1); %>
        <ul data-role="listview" data-inset="true" class="ui-listview ui-listview-inset ui-corner-all ui-shadow">
            <% if (creation.get(st)) { %>
            <li data-role="list-divider"><%= ust %><p><%= character.get(st) %></p></li>
            <li><a href="#charactercreate/simpletext/<%= st %>s/<%= st %>/<%= character.id %>/pick">Repick <%= ust %></a></li>
            <% } else { %>
            <li><a href="#charactercreate/simpletext/<%= st %>s/<%= st %>/<%= character.id %>/pick">Pick <%= ust %></a></li>
            <% } %>
        </ul>
    <% }) %>

    <ul data-role="listview" data-inset="true" class="ui-listview ui-listview-inset ui-corner-all ui-shadow">
        <li data-role="list-divider">Attributes<span class="ui-li-count"><%= creation.remaining_picks("attributes") %></span></li>
        <% _.each(_.range(8, 0, -1), function(i) { %>
        <% var n = "attributes_" + i + "_remaining"; %>
        <% _.each(creation.get("attributes_" + i + "_picks"), function(st) { %>
        <li data-icon="delete">
            <a href="javascript: void(0)"><%= st.get("name") %> x<%= st.get("value") %></a>
            <a href="#charactercreate/simpletraits/attributes/<%= character.id %>/unpick/<%= st.linkId() %>/<%= i %>">Delete</a>
        </li>
        <% }); %>
        <% _.each(_.range(creation.get(n)), function() { %>
        <li><a href="#charactercreate/simpletraits/attributes/<%= character.id %>/pick/<%= i %>">Pick attribute at rating <%= i %></a></li>
        <% }) %>
        <% }); %>
    </ul>

    <% _.each(_.zip(["Physical", "Social", "Mental"], ["focus_physicals", "focus_socials", "focus_mentals"]), function(z) { %>
    <% var prettyName = z[0]; %>
    <% var category = z[1]; %>
    <ul data-role="listview" data-inset="true" class="ui-listview ui-listview-inset ui-corner-all ui-shadow">
        <li data-role="list-divider"><%= prettyName %> Focus<span class="ui-li-count"><%= creation.remaining_picks(category) %></span></li>
        <% _.each(_.range(2, 0, -1), function(i) { %>
        <% var n = category + "_" + i + "_remaining"; %>
        <% _.each(creation.get(category + "_" + i + "_picks"), function(st) { %>
        <li data-icon="delete">
            <a href="javascript: void(0)"><%= st.get("name") %></a>
            <a href="#charactercreate/simpletraits/<%= category %>/<%= character.id %>/unpick/<%= st.linkId() %>/<%= i %>">Delete</a>
        </li>
        <% }); %>
        <% _.each(_.range(creation.get(n)), function() { %>
        <li><a href="#charactercreate/simpletraits/<%= category %>/<%= character.id %>/pick/<%= i %>">Pick <%= prettyName %> Focus</a></li>
        <% }) %>
        <% }); %>
    </ul>
    <% }); %>


    <ul data-role="listview" data-inset="true" class="ui-listview ui-listview-inset ui-corner-all ui-shadow">
        <li data-role="list-divider">Skills<span class="ui-li-count"><%= creation.remaining_picks("skills") %></span></li>
        <% _.each(_.range(4, 0, -1), function(i) { %>
            <% var n = "skills_" + i + "_remaining"; %>
            <% _.each(creation.get("skills_" + i + "_picks"), function(st) { %>
                <li data-icon="delete">
                    <a href="javascript: void(0)"><%= st.get("name") %> x<%= st.get("value") %></a>
                    <a href="#charactercreate/simpletraits/skills/<%= character.id %>/unpick/<%= st.linkId() %>/<%= i %>">Delete</a>
                </li>
            <% }); %>
            <% _.each(_.range(creation.get(n)), function() { %>
                <li><a href="#charactercreate/simpletraits/skills/<%= character.id %>/pick/<%= i %>">Pick skill at rating <%= i %></a></li>
            <% }) %>
        <% }); %>
    </ul>


    <ul data-role="listview" data-inset="true" class="ui-listview ui-listview-inset ui-corner-all ui-shadow">
        <li data-role="list-divider">Backgrounds<span class="ui-li-count"><%= creation.remaining_picks("backgrounds") %></span></li>
        <% _.each(_.range(3, 0, -1), function(i) { %>
        <% var n = "backgrounds_" + i + "_remaining"; %>
        <% _.each(creation.get("backgrounds_" + i + "_picks"), function(st) { %>
        <li data-icon="delete">
            <a href="javascript: void(0)"><%= st.get("name") %> x<%= st.get("value") %></a>
            <a href="#charactercreate/simpletraits/backgrounds/<%= character.id %>/unpick/<%= st.linkId() %>/<%= i %>">Delete</a>
        </li>
        <% }); %>
        <% _.each(_.range(creation.get(n)), function() { %>
        <li><a href="#charactercreate/simpletraits/backgrounds/<%= character.id %>/pick/<%= i %>">Pick a background at rating <%= i %></a></li>
        <% }); %>
        <% }); %>
    </ul>

    <ul data-role="listview" data-inset="true" class="ui-listview ui-listview-inset ui-corner-all ui-shadow">
        <li data-role="list-divider">Disciplines<span class="ui-li-count"><%= creation.remaining_picks("disciplines") %></span></li>
        <% _.each(_.range(2, 0, -1), function(i) { %>
            <% var n = "disciplines_" + i + "_remaining"; %>
            <% _.each(creation.get("disciplines_" + i + "_picks"), function(st) { %>
            <li data-icon="delete">
                <a href="javascript: void(0)"><%= st.get("name") %> x<%= st.get("value") %></a>
                <a href="#charactercreate/simpletraits/disciplines/<%= character.id %>/unpick/<%= st.linkId() %>/<%= i %>">Delete</a>
            </li>
            <% }); %>
            <% _.each(_.range(creation.get(n)), function() { %>
            <li><a href="#charactercreate/simpletraits/disciplines/<%= character.id %>/pick/<%= i %>">Pick in clan discipline at rating <%= i %></a></li>
            <% }); %>
        <% }); %>
    </ul>

    <ul data-role="listview" data-inset="true" class="ui-listview ui-listview-inset ui-corner-all ui-shadow" category="merits">
        <li data-role="list-divider">Merits<span class="ui-li-count"><%= creation.remaining_picks("merits") %></span></li>
        <% _.each(_.range(1, -1, -1), function(i) { %>
        <% var n = "merits_" + i + "_remaining"; %>
        <% _.each(creation.get("merits_" + i + "_picks"), function(st) { %>
        <li data-icon="delete">
            <a href="javascript: void(0)"><%= st.get("name") %> x<%= st.get("value") %></a>
            <a href="#charactercreate/simpletraits/merits/<%= character.id %>/unpick/<%= st.linkId() %>/<%= i %>">Delete</a>
        </li>
        <% }); %>
        <% _.each(_.range(creation.get(n)), function() { %>
        <li><a href="#charactercreate/simpletraits/merits/<%= character.id %>/pick/<%= i %>">Pick merit</a></li>
        <% }); %>
        <% }); %>
    </ul>

    <ul data-role="listview" data-inset="true" class="ui-listview ui-listview-inset ui-corner-all ui-shadow">
        <li data-role="list-divider">Flaws<span class="ui-li-count"><%= creation.remaining_picks("flaws") %></span></li>
        <% _.each(_.range(1, -1, -1), function(i) { %>
        <% var n = "flaws_" + i + "_remaining"; %>
        <% _.each(creation.get("flaws_" + i + "_picks"), function(st) { %>
        <li data-icon="delete">
            <a href="javascript: void(0)"><%= st.get("name") %> x<%= st.get("value") %></a>
            <a href="#charactercreate/simpletraits/flaws/<%= character.id %>/unpick/<%= st.linkId() %>/<%= i %>">Delete</a>
        </li>
        <% }); %>
        <% _.each(_.range(creation.get(n)), function() { %>
        <li><a href="#charactercreate/simpletraits/flaws/<%= character.id %>/pick/<%= i %>">Pick flaw</a></li>
        <% }); %>
        <% }); %>
    </ul>

</script>

<div id="characters-all" data-role="page" data-title="Characters">

    <div role="main" class="ui-content">
        <ul>
            <li><a href="#characternew">Add New Vampire</a></li>
        </ul>
        <ul data-role="listview" data-inset="true">
        </ul>
    </div><!-- /content -->
</div>

<div id="simpletraitcategory-all" data-role="page" data-title="SimpleTraitCategoryAll">

    <div role="main" class="ui-content">
    </div>
</div>

<script id="simpleTraitCategoryView" type="text/template">
    <ul>
        <li><a href="#simpletraits/<%= category %>/<%= character.id %>/new">Add New <%= category %></a></li>
    </ul>
    <ul>
        <% if (character.has(category)) { _.each(character.get(category), function(e) { %>
        <li>
            <a href="#simpletrait/<%= category %>/<%= character.id %>/<%= e.id %>" class="ui-btn ui-btn-icon-right ui-icon-carat-r"><%= e.get("name") %> x<%= e.get("value") %></a>
        </li>
        <% }); } %>
    </ul>
</script>

<div id="simpletrait-change" data-role="page" data-title="SimpleTraitChange">

    <div role="main" class="ui-content">
        <!-- <div id="simpletrait-main"></div> -->
        <div id="simpletrait-viewing"></div>
        <div id="simpletrait-changing"></div>
    </div>
</div>

<script id="simpleTraitChangeView" type="text/template">
    <p><%= c.get("name") %> <%= b.get("name") %> <%= b.get("value") %></p>
    <% var cost = character.calculate_trait_to_spend(trait); %>
    <p>Cost: <%= cost %></p>
    <p>Available XP: <%= character.experience_available() %></p>
    <p>Final: <%= character.experience_available() - cost %></p>
</script>

<script id="simpleTraitChangeChange" type="text/template">
    <p>
        <label for="value-slider">Slider:</label>
        <input type="range" name="simpleTraitValue" id="value-slider" class="value-slider" value="<%= b.get('value') %>" min="1" max="<%= traitmax %>">
    </p>
    <p>
        <button class="remove ui-btn">Remove</button>
        <button class="save ui-btn">Save Changes</button>
    </p>
    <p>
        <h2>Advanced Options</h2>
        <label for="specialize-name">Specialize Name</label>
        <input type="text" id="specialize-name" name="specialize-name" value="<%= b.get_specialization() %>">
        <label for="free-slider">Free Value:</label>
        <input type="range" name="free-slider" id="free-slider" class="free-slider" value="<%= b.get('free_value') || 0 %>" min="0" max="<%= traitmax %>">
    </p>
</script>

<div id="victims-all" data-role="page" data-title="VictimsAll">

    <div role="main" class="ui-content">
        <ul>
            <li>All</li>
            <li>Idle</li>
            <li>Occupied</li>
        </ul>
    </div>
</div>

<div id="experience-notations-all" data-role="page" data-role="Experience Notations">
    <div role="main" class="ui-content">
    </div>
</div>

<script id="experienceNotationsAllView" type="text/template">
    <p>Earned: <%= character.get("experience_earned") %></p>
    <p>Spent: <%= character.get("experience_spent") %></p>
    <p>Available: <%= character.experience_available() %></p>
    <button class="add ui-btn ui-btn-icon-plus">Add New Notation</button>
    <!--
    <button class="previous ui-btn ui-btn-icon-left">View Previous</button>
    <button class="next ui-btn ui-btn-icon-left">View Next</button>
    -->
    <% var headers = ["entered", "reason", "alteration_earned", "alteration_spent", "earned", "spent"]; %>
    <% var editable = ["entered", "reason", "alteration_earned", "alteration_spent"]; %>
    <table data-role="table" id="table-column-toggle" class="ui-responsive table-stroke">
        <thead>
        <tr>
            <% _.each(headers, function (h, i) { %>
            <th data-priority="<%= i + 1 %>"><%= h %></th>
            <% }); %>
            <th></th>
        </tr>
        </thead>
        <tbody>
            <% _.each(logs, function (log, i) { %>
                <tr>
                    <% _.each(headers, function (h) { %>
                    <td>
                        <% if (_.contains(editable, h)) { %>
                        <a href="#" class="experience-notation-edit ui-btn ui-icon-edit ui-btn-icon-notext ui-corner-all ui-btn-inline" header="<%= h %>" notation-id="<%= log.cid %>">Edit</a>
                        <% } %>
                        <%= format_entry(log, h) %>
                    </td>
                    <% }); %>
                    <td><a href="#" class="experience-notation-delete ui-btn ui-icon-delete ui-btn-icon-notext ui-corner-all ui-btn-inline" notation-id="<%= log.cid %>">Delete</a></td>
                </tr>
            <% }); %>
        </tbody>
    </table>
    <div data-role="popup" id="popupEditEntered" data-theme="a" class="ui-corner-all">
        <form id="edit-entered-popup-form">
            <div style="padding:10px 20px;">
                <input type="text" id="date-input" data-inline="true" data-role="date">
                <button type="submit" class="ui-btn ui-corner-all ui-shadow ui-btn-b ui-btn-icon-left ui-icon-check">
                    Update Date Entered
                </button>
                <input type="hidden" id="date-id"/>
            </div>
        </form>
    </div>
    <div data-role="popup" id="popupEditReason" data-theme="a" class="ui-corner-all">
        <form id="edit-reason-popup-form">
            <div style="padding:10px 20px;">
                <textarea id="reason-input"></textarea>
                <button type="submit" class="ui-btn ui-corner-all ui-shadow ui-btn-b ui-btn-icon-left ui-icon-check">
                    Update Reason
                </button>
                <input type="hidden" id="reason-id"/>
            </div>
        </form>
    </div>
    <div data-role="popup" id="alterationpopupEdit" data-theme="a" class="ui-corner-all">
        <form id="edit-alteration-popup-form">
            <div style="padding:10px 20px;">
                <input type="number" id="alteration-input"></input>
                <button type="submit" class="ui-btn ui-corner-all ui-shadow ui-btn-b ui-btn-icon-left ui-icon-check">
                    Update Alteration Value
                </button>
                <input type="hidden" id="alteration-id"/>
                <input type="hidden" id="alteration-type"/>
            </div>
        </form>
    </div>
    <div data-role="popup" id="popupEditLogin" data-theme="a" class="ui-corner-all">
        <form>
            <div style="padding:10px 20px;">
                <h3>Please sign in</h3>
                <label for="un" class="ui-hidden-accessible">Username:</label>
                <input type="text" name="user" id="un" value="" placeholder="username" data-theme="a">
                <label for="pw" class="ui-hidden-accessible">Password:</label>
                <input type="password" name="pass" id="pw" value="" placeholder="password" data-theme="a">
                <button type="submit" class="ui-btn ui-corner-all ui-shadow ui-btn-b ui-btn-icon-left ui-icon-check">
                    Sign in
                </button>
            </div>
        </form>
    </div>
</script>

<div id="experience-notation-change" data-role="page" data-role="Change Experience Notation">
    <div role="main" class="ui-content">
    </div>
</div>

<script>
</script>

<div id="animals" data-role="page" data-title="Animals">

      <div data-role="header">
	    <h1>Animals</h1>
      </div><!-- /header -->
  
      <div role="main" class="ui-content">
            <ul data-role="listview" data-inset="true">
            </ul>
      </div><!-- /content -->
</div>

<div id="colors" data-role="page" data-title="Colors">

      <div data-role="header">
	    <h1>Colors</h1>
      </div><!-- /header -->

      <div role="main" class="ui-content">
            <ul data-role="listview" data-inset="true">
            </ul>
      </div><!-- /content -->

</div>

<div id="vehicles" data-role="page" data-title="Vehicles">

      <div data-role="header">
	    <h1>Vehicles</h1>
      </div><!-- /header -->
  
      <div role="main" class="ui-content">
            <ul data-role="listview" data-inset="true">
            </ul>
      </div><!-- /content -->

</div>

<div id="character-new" data-role="page" data-title="New Character">

    <div role="main" class="ui-content">
    </div>
</div>

<script id="characterNewView" type="text/template">
    <form>
        <label for="characterName">Name:</label>
        <input type="text" name="characterName" id="characterName" value="New Character Name">
    </form>
    <p>
        <button class="cancel ui-btn">Cancel</button>
        <button class="save ui-btn">Save Changes</button>
    </p>
</script>

<div id="simpletrait-new" data-role="page" data-title="New Simple Trait">
    <div role="main" class="ui-content">
    </div>
</div>

<script id="simpletraitcategoryDescriptionItems" type="text/template">
    <% if (freeValue) { %>
        <p>Pick one for value <%= freeValue %></p>
    <% } %>
    <form class="ui-filterable">
        <input id="filterBasic-input" data-type="search">
    </form>
    <ul data-role="listview" data-filter="true" data-input="#filterBasic-input">
    <% _.each(collection, function(e) { %>
        <li>
            <a name="<%= e.get('name') %>" backendId="<%= e.id %>" href="#" class="ui-btn ui-btn-icon-right ui-icon-carat-r simpletrait">
                <% if (e.has("value")) { %>
                    <%= e.get("name") %> x<%= e.get("value") %>
                <% } else { %>
                    <%= e.get("name") %>
                <% } %>
            </a>
        </li>
    <% }); %>
    </ul>
</script>

<div id="simpletext-new" data-role="page" data-title="New Simple Text">

    <div role="main" class="ui-content">
    </div>
</div>

<script id="simpletextcategoryDescriptionItems" type="text/template">
    <ul data-role="listview" data-inset="true" data-filter="true">
        <% collection.each(function(e) { %>
        <li>
            <a name="<%= e.get('name') %>"  href="#" class="ui-btn ui-btn-icon-right ui-icon-carat-r simpletext"><%= e.get("name") %></a>
        </li>
        <% }); %>
    </ul>
</script>

<!-- Underscore Template that is used to display all of the Category Models -->
<script id="categoryItems" type="text/template">

      <% _.each( collection.toJSON(), function( category, id ) { %>

            <li class="ui-li-static">
                  <%= category.type %>
            </li>

      <% }); %>

</script>

<div id="character-costs" data-role="page" data-title="Character Costs">

    <div role="main" class="ui-content">
    </div>
</div>

<script id="characterCostsView" type="text/template">
    <h1><%= character.get("name") %></h1>

    <% if (!character.has_generation()) { %>
    <p>Warning: Values are just a guess without a generation set</p>
    <% } %>

    <ul>
        <% _.each(_.values(costs), function(cost) { %>
        <li><%= cost.trait.get("name") %>: <%= cost.cost %></li>
        <% }); %>
    </ul>
</script>

<div id="printable-sheet" data-role="page" data-title="Printable Sheet">
    <div role="main" class="ui-content">
    </div>
</div>

<script id="characterPrintView" type="text/template">
    <h1 class="ui-bar ui-bar-a"><%= character.get("name") %></h1>
    <div class="ui-grid-b ui-responsive">
        <div class="ui-block-a">
            <h2 class="ui-bar ui-bar-a">Clan: <%= character.get("clan") %></h2>
        </div>
        <div class="ui-block-b">
            <h2 class="ui-bar ui-bar-a">Archetype: <%= character.get("archetype") %></h2>
        </div>
    </div>
    <div class="ui-grid-b ui-responsive">
        <div class="ui-block-a">
            <h2 class="ui-bar ui-bar-a">Sect: <%= character.get("sect") %></h2>
        </div>
        <div class="ui-block-b">
            <h2 class="ui-bar ui-bar-a">Faction: <%= character.get("faction") %></h2>
        </div>
        <div class="ui-block-c">
            <h2 class="ui-bar ui-bar-a">Title: <%= character.get("title") %></h2>
        </div>
    </div>
    <% var cl = {0: "a", 1: "b", 2: "c" }; %>
    <div class="ui-grid-b ui-responsive">
    <% _.each(character.get("attributes"), function (attribute, i) { %>
        <% var name = attribute.get("name") || ""; %>
        <div class="ui-block-<%= cl[i] %>">
            <h4 class="ui-bar ui-bar-a ui-corner-all"><%= name %></h4>
            <div class="ui-body">
                <%= attribute.get("value") %>
                <br/>
                <% var focusName = "focus_" + name.toLowerCase() + "s"; %>
                <% _.each(character.get(focusName), function (focus) { %>
                <%= focus.get("name") %>
                <% }); %>
            </div>
        </div>
    <% }); %>
    </div>
        <% var bptLookup = {1: 10, 2: 12, 3: 15, 4: 20, 5: 30 } %>
    <div class="ui-grid-b ui-responsive">
        <div class="ui-block-a">
            <h4 class="ui-bar ui-bar-a ui-corner-all">Blood</h4>
            <% _.each(_.range(1, 31), function(i) { %>
                <i class="fa fa-square-o"></i>
                <% if (0 == i % 5) { %>
                &nbsp;
                <% } %>
                <% if (0 == i % 10) { %>
                <br/>
                <% } %>
            <% }); %>
            <% _.each(_.range(character.generation()), function(i) { %>
                <i class="fa fa-circle"></i>
            <% }); %>
            <%= bptLookup[character.generation()] %> / <%= character.generation() %>
        </div>
        <div class="ui-block-b">
            <h4 class="ui-bar ui-bar-a ui-corner-all">Willpower</h4>
            <% _.each(_.range(0, character.get_willpower_total()), function (i) { %>
                <i class="fa fa-square-o"></i>
                <% if (0 == (i + 1) % 5) { %>
                &nbsp;
                <% } %>
            <% }); %>
            <h4 class="ui-bar ui-bar-a ui-corner-all">Morality</h4>
            <%= character.morality().get("name") %><br/>
            <% _.each(_.range(1, _.parseInt(character.morality().get("value")) + 1), function(i) { %>
                <i class="fa fa-square-o"></i>
                <% if (0 == i % 5) { %>
                &nbsp;
                <% } %>
            <% }); %>
        </div>
        <div class="ui-block-c">
            <h4 class="ui-bar ui-bar-a ui-corner-all">Health Levels</h4>
            <% _.forIn(character.health_levels(), function (args) { %>
                <% _.each(_.range(_.parseInt(args[1])), function(i) { %>
                    <i class="fa fa-square-o"></i>
                <% }); %>
                <%= args[0] %>
                <br/>
            <% }); %>
        </div>
    </div>
    <h4 class="ui-bar ui-bar-a">Skills</h4>
    <div class="ui-grid-b ui-responsive">
        <% _.each(groupedSkills, function(three_group) { %>
            <% _.each(three_group, function(skill, i) { %>
            <% if (skill) { %>
            <div class="ui-block-<%= cl[i % 3] %>">
                <div class="ui-body" style="overflow: hidden; white-space:nowrap">
                    <%= skill %>
                </div>
            </div>
            <% } %>
            <% }); %>
        <% }); %>
    </div>
    <div class="ui-grid-b ui-responsive">
        <div class="ui-block-a">
            <h4 class="ui-bar ui-bar-a ui-corner-all">Backgrounds</h4>
            <% _.each(character.get("backgrounds"), function(background) { %>
                <%= background.get("name") %>: <%= background.get("value") %>
                <% if (background.get("name") == "Haven") { %>
                    <br/>&nbsp;&nbsp;<%= _.pluck(character.get("haven_specializations"), "attributes.name").join("<br/>&nbsp;&nbsp;") %>
                <% } else if (background.get("name") == "Influences: The Elite") { %>
                    <br/>&nbsp;&nbsp;<%= _.pluck(character.get("influence_elite_specializations"), "attributes.name").join("<br/>&nbsp;&nbsp;") %>
                <% } else if (background.get("name") == "Influences: The Underworld") { %>
                    <br/>&nbsp;&nbsp;<%= _.pluck(character.get("influence_underworld_specializations"), "attributes.name").join("<br/>&nbsp;&nbsp;") %>
                <% } else if (background.get("name") == "Contacts") { %>
                    <br/>&nbsp;&nbsp;<%= _.pluck(character.get("contacts_specializations"), "attributes.name").join("<br/>&nbsp;&nbsp;") %>
                <% } else if (background.get("name") == "Rituals") { %>
                    <br/>&nbsp;&nbsp;<%= _.pluck(character.get("sabbat_rituals"), "attributes.name").join("<br/>&nbsp;&nbsp;") %>
                <% } else if (background.get("name") == "Allies") { %>
                    <br/>&nbsp;&nbsp;<%= _.pluck(character.get("allies_specializations"), "attributes.name").join("<br/>&nbsp;&nbsp;") %>
                <% } %>
                <br/>
            <% }); %>
        </div>
        <div class="ui-block-b">
            <h4 class="ui-bar ui-bar-a ui-corner-all">Disciplines</h4>
            <% _.each(_.chain(character.get("disciplines")).sortBy("attributes.name").value(), function(d) { %>
                <%= d.get("name") %>: <%= d.get("value") %><br/>
            <% }); %>
            <% if (character.has("techniques")) { %>
            <h4 class="ui-bar ui-bar-a ui-corner-all">Techniques</h4>
            <% _.each(_.chain(character.get("techniques")).sortBy("attributes.name").value(), function(d) { %>
                <%= d.get("name") %><br/>
            <% }); %>
            <% } %>
            <% if (character.has("elder_disciplines")) { %>
            <h4 class="ui-bar ui-bar-a ui-corner-all">Elder Disciplines</h4>
            <% _.each(_.chain(character.get("elder_disciplines")).sortBy("attributes.name").value(), function(d) { %>
                <%= d.get("name") %><br/>
            <% }); %>
            <% } %>
        </div>
        <div class="ui-block-c">
            <% if (character.has("merits")) { %>
            <h4 class="ui-bar ui-bar-a ui-corner-all">Merits</h4>
            <% _.each(character.get("merits"), function(d) { %>
                <%= d.get("name") %>: <%= d.get("value") %><br/>
            <% }); %>
            <% } %>
            <% if (character.has("flaws")) { %>
            <h4 class="ui-bar ui-bar-a ui-corner-all">Flaws</h4>
            <% _.each(character.get("flaws"), function(d) { %>
                <%= d.get("name") %>: <%= d.get("value") %><br/>
            <% }); %>
            <% } %>
            <% if (character.has("status_traits")) { %>
            <h4 class="ui-bar ui-bar-a ui-corner-all">Status</h4>
            <% _.each(character.get("status_traits"), function(d) { %>
                <%= d.get("name") %>: <%= d.get("value") %><br/>
            <% }); %>
            <% } %>
        </div>
    </div>
    <div class="ui-grid-b ui-responsive">
        <div class="ui-block-a">
            <% if (character.has("lore_specializations")) { %>
            <h4 class="ui-bar ui-bar-a ui-corner-all">Lores</h4>
            <%= _.pluck(character.get("lore_specializations"), "attributes.name").join("<br/>") %>
            <% } %>
            <% if (character.has("academics_specializations")) { %>
            <h4 class="ui-bar ui-bar-a ui-corner-all">Academics</h4>
            <%= _.pluck(character.get("academics_specializations"), "attributes.name").join("<br/>") %>
            <% } %>
        </div>
        <div class="ui-block-b">
            <% if (character.has("rituals")) { %>
            <h4 class="ui-bar ui-bar-a ui-corner-all">Rituals</h4>
            <%= _.pluck(character.get("rituals"), "attributes.name").join("<br/>") %>
            <% } %>
        </div>
        <div class="ui-block-c">
            <% if (character.has("linguistics_specializations")) { %>
            <h4 class="ui-bar ui-bar-a ui-corner-all">Languages</h4>
            <%= _.pluck(character.get("linguistics_specializations"), "attributes.name").join("<br/>") %>
            <% } %>
            <% if (character.has("drive_specializations")) { %>
            <h4 class="ui-bar ui-bar-a ui-corner-all">Drive</h4>
            <%= _.pluck(character.get("drive_specializations"), "attributes.name").join("<br/>") %>
            <% } %>
        </div>
    </div>
</script>

<script type="text/template" id="login-template">
    <div class="login">
        <img style="width: 100%;" src="UndergroundTheaterBlackLogo.jpg"/>
        Welcome to Yorick, a character management system for <a href="http://www.undergroundtheater.org/">Underground Theater</a>.
        <form class="login-form">
            <h2>Log In</h2>
            <div class="error" style="display:none"></div>
            <input type="text" id="login-username" placeholder="Username" />
            <input type="password" id="login-password" placeholder="Password" />
            <button>Log In</button>
        </form>
        <a href="#signup">Need an account? Sign up!</a>
    </div>
</script>

<script type="text/template" id="signup-template">
    <div class="signup">
        <img src="VinesLogoSmall.png"/>
        Sign up for Twisted Vines
        <form class="signup-form">
            <h2>Sign Up</h2>
            <div class="error" style="display:none"></div>
            <input type="text" id="signup-username" placeholder="Username" />
            <input type="password" id="signup-password" placeholder="Create a Password" />
            <button>Sign Up</button>
        </form>
    </div>
</script>

<div id="simpletrait-specialization" data-role="page" data-title="Simple Trait Specialization">
    <div role="main" class="ui-content">
    </div>
</div>

<script id="simpleTraitSpecialization" type="text/template">
    <form>
        <label for="specialization">Specialization for <%= name %>:</label>
        <input type="text" name="specialization" id="specialization" value="<%= specialization %>">
    </form>
    <p>
        <button class="cancel ui-btn">Cancel</button>
        <button class="save ui-btn">Save Changes</button>
    </p>
</script>

<div id="character-log" data-role="page" data-title="Character Log">
    <div role="main" class="ui-content">
    </div>
</div>

<script id="characterLogView" type="text/template">
    <h1><%= character.get("name") %></h1>
    <button class="previous ui-btn ui-btn-icon-left">Previous</button>
    <button class="next ui-btn ui-btn-icon-left">Next</button>
    <% var headers = ["createdAt", "category", "name", "type", "old_value", "value", "old_free_value", "free_value", "old_cost", "cost", "old_text", "new_text"]; %>
    <table data-role="table" id="table-column-toggle" class="ui-responsive table-stroke">
        <thead>
        <tr>
            <% _.each(headers, function (h, i) { %>
            <th data-priority="<%= i + 1 %>"><%= h %></th>
            <% }); %>
        </tr>
        </thead>
        <tbody>
            <% _.each(logs, function (log, i) { %>
                <tr>
                    <% _.each(headers, function (h) { %>
                    <td><%= format_entry(log, h) %></td>
                    <% }); %>
                </tr>
            <% }); %>
        </tbody>
    </table>
</script>

<div id="character-history" data-role="page" data-title="Character History">
    <div role="main" class="ui-content">
        <div id="history-main"></div>
        <div id="history-viewing"></div>
        <div id="history-sheet"></div>
    </div>
</div>

<script id="characterHistoryView" type="text/template">
    <h1><%= character.get("name") %></h1>
    <p>
        <label for="slider">Point it time:</label>
        <input type="range" name="historyChangePicker" id="slider" value="<%= idForPickedIndex %>" min="0" max="<%= logs.length - 1 %>">
        <% _.each(logs, function (log, i) { %>
        <input type="hidden" value="<%= log.id %>" id="history-changes-<%= i %>" />
        <% }); %>
    </p>
</script>

<script id="characterHistorySelectedView" type="text/template">
    <span>Showing changes including</span>
    <% var headers = ["createdAt", "category", "name", "type", "old_value", "value", "old_free_value", "free_value", "old_cost", "cost", "old_text", "new_text"]; %>
    <table data-role="table" id="table-column-toggle" class="ui-responsive table-stroke">
        <thead>
        <tr>
            <% _.each(headers, function (h, i) { %>
            <th data-priority="<%= i + 1 %>"><%= h %></th>
            <% }); %>
        </tr>
        </thead>
        <tbody>
        <% _.each([logs[idForPickedIndex]], function (log, i) { %>
        <tr>
            <% _.each(headers, function (h) { %>
            <td><%= format_entry(log, h) %></td>
            <% }); %>
        </tr>
        <% }); %>
        </tbody>
    </table>
    <%= idForPickedIndex %>
    <%= logs.length - 1 %>
    <% if (idForPickedIndex != logs.length - 1) { %>
        <span>Just undid</span>
        <% var undoneLog = _.min([idForPickedIndex + 1, logs.length - 1]); %>
        <table data-role="table" id="table-column-toggle" class="ui-responsive table-stroke">
            <thead>
            <tr>
                <% _.each(headers, function (h, i) { %>
                <th data-priority="<%= i + 1 %>"><%= h %></th>
                <% }); %>
            </tr>
            </thead>
            <tbody>
            <% _.each([logs[undoneLog]], function (log, i) { %>
            <tr>
                <% _.each(headers, function (h) { %>
                <td><%= format_entry(log, h) %></td>
                <% }); %>
            </tr>
            <% }); %>
            </tbody>
        </table>
    <% }; %>
</script>

<div id="user-settings-profile" data-role="page" data-title="Profile">
    <div role="main" class="ui-content">
    </div>
</div>

<script id="userSettingsProfileView" type="text/template">
    <h1><%= user.get("name") %></h1>
    <form class="profile-form">
        <div class="error" style="display:none"></div>
        <label for="input-name">Name</label>
        <input type="text" name="input-name" id="input-name" value="<%= user.get('realname') %>">
        <label for="input-email">Email</label>
        <input type="text" name="input-email" id="input-email" value="<%= user.get('email') %>">
        <button class="ui-shadow ui-btn ui-corner-all ui-icon-action ui-btn-icon-right update" disabled="">Update</button>
    </form>
</script>

<div id="character-portrait" data-role="page" data-title="Profile">
    <div role="main" class="ui-content">
    </div>
</div>

<script id="characterPortraitView" type="text/template">
    <h1><%= character.get("name") %></h1>
    <% if (character.get('portrait')) { %>
    <img src="<%= character.get('portrait').get('original').url() %>"/>
    <% } %>
    <form class="portrait-form">
        <div class="error" style="display:none"></div>
        <label for="input-portrait">Portrait</label>
        <input type="file" name="input-portrait" id="input-portrait">
        <button class="ui-shadow ui-btn ui-corner-all ui-icon-action ui-btn-icon-right update">Upload</button>
    </form>
</script>

<div id="troupe-portrait" data-role="page" data-title="Profile">
    <div role="main" class="ui-content">
    </div>
</div>


<script id="troupePortraitView" type="text/template">
    <h1><%= troupe.get("name") %></h1>
    <% if (troupe.get('portrait')) { %>
    <img src="<%= troupe.get('portrait').get('original').url() %>"/>
    <% } %>
    <form class="portrait-form">
        <div class="error" style="display:none"></div>
        <label for="input-portrait">Portrait</label>
        <input type="file" name="input-portrait" id="troupe-input-portrait">
        <button class="ui-shadow ui-btn ui-corner-all ui-icon-action ui-btn-icon-right update">Upload</button>
    </form>
</script>

<div id="troupe-character-relationships-network" data-role="page" data-title="Relationships Network">
    <div role="main" class="ui-content">
    </div>
</div>

<script id="troupeCharacterRelationshipsNetworkView" type="text/template">
    <div id="relationships-network"></div>
    <div id="relationships-network-data-display">
        <button class="ui-shadow ui-btn ui-corner-all ui-icon-action ui-btn-icon-right make-relationship" disabled="">Create Relationship</button>
    </div>
    <div id="relationships-network-select-characters">
        <fieldset data-role="controlgroup">
            <legend>Characters to display:</legend>
            <% _.each(characters, function (character, i) { %>
            <% var n = "checkbox-" + character.id || character.cid; %>
            <input type="checkbox" name="<%= n %>" id="<%= n %>">
            <label for="<%= n %>"><%= character.get("name") %></label>
            <% }) %>
        </fieldset>
    </div>
</script>

<div id="character-delete" data-role="page" data-title="Delete Character">
    <div role="main" class="ui-content">
    </div>
</div>

<script id="characterDeleteView" type="text/template">
    <h1>Are you sure you want to delete <%= character.get("name") %>?</h1>
    <button class="delete-character">Delete <%= character.get("name") %></button>
</script>

<!-- <script data-main="scripts/app" src="scripts/lib/require.js?bust=4"></script> -->
</body>
</html>
